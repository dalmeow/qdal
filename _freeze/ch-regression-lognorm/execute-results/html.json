{
  "hash": "b58f9b122d1f789e241dc0ec46e25d3e",
  "result": {
    "engine": "knitr",
    "markdown": "# Log-normal regression {#sec-regression-lognorm}\n\n<!--# TODO: lognormal -->\n\n\n\nIn @sec-probability, we talked about skewness of distributions in relation to the density plots of reaction times. In @sec-gauss-model, we further explained that it is the onus of the researcher to decide on a distribution family when fitting regression models and we said that, in the absence of more specific knowledge, the Gaussian distribution is a safe assumption to make. Note that the choice of distribution family should be based as much as possible on theoretical grounds (as opposed to empirical). In other words, you shouldn't plot the variable to check with distribution it might follow (more on this in the Important box below).\n\nThere are heuristics one can follow to pick a theoretically grounded distribution. The major ones are listed in @sec-outcome, so you can refer to that section in the appendix, but in this chapter we will focus on one type of variables and the default distribution choice: i.e. variables that can only take on values that are positive numbers. These variables, in the absence of more specific knowledge, can be assumed to be from a log-normal distribution.\n\n## Log-normal distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmald <- readRDS(\"data/tucker2019/mald_1_1.rds\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmald |> \n  ggplot(aes(RT, fill = IsWord)) +\n  geom_density(alpha = 0.5) +\n  geom_rug()\n```\n\n::: {.cell-output-display}\n![](ch-regression-lognorm_files/figure-html/fig-rt-lognorm-1.png){#fig-rt-lognorm width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmald |> \n  ggplot(aes(log(RT), fill = IsWord)) +\n  geom_density(alpha = 0.5) +\n  geom_rug()\n```\n\n::: {.cell-output-display}\n![](ch-regression-lognorm_files/figure-html/fig-rt-gaussian-log-1.png){#fig-rt-gaussian-log width=672}\n:::\n:::\n\n\n::: callout-important\n**Looking at a density plot is not a safe way to decide if you need to log a variable or if a variable is log-normal.**\n\nThere are cases where the density plot is a combination of multiple underlying distributions with different means and SDs that makes it look as if it is skewed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n\n# Sample sizes\nn <- 2000\n\n# Three different normal distributions\nx1 <- rnorm(n, mean = 2, sd = 0.5)\nx2 <- rnorm(n, mean = 3, sd = 1.5)\nx3 <- rnorm(n, mean = 4, sd = 3)\n\ndat <- tibble(\n  x = c(x1, x2, x3),\n  gr = rep(c(\"a\", \"b\", \"c\"), each = n)\n)\n\ndat |> \n  ggplot(aes(x)) +\n  geom_density() +\n  geom_rug()\n```\n\n::: {.cell-output-display}\n![](ch-regression-lognorm_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndat |> \n  ggplot(aes(x, fill = gr)) +\n  geom_density(alpha = 0.5) +\n  geom_rug()\n```\n\n::: {.cell-output-display}\n![](ch-regression-lognorm_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrt_bm_1 <- brm(\n  RT ~ IsWord,\n  family = gaussian,\n  data = mald,\n  seed = 6725,\n  file = \"cache/ch-regression-cat-rt_bm_1\"\n)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npp_check(rt_bm_1, ndraws = 50)\n```\n\n::: {.cell-output-display}\n![](ch-regression-lognorm_files/figure-html/rt-bm-1-pp-1.png){width=672}\n:::\n:::\n\n\n$$\n\\begin{align}\nRT_i & \\sim LogNormal(\\mu_i, \\sigma)\\\\\n\\mu_i & = \\beta_0 + \\beta_1 \\cdot sr_i\\\\\n\\end{align}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrt_bm_2 <- brm(\n  RT ~ IsWord,\n  family = lognormal,\n  data = mald,\n  cores = 4,\n  seed = 6725,\n  file = \"cache/ch-regression-cat-rt_bm_2\"\n)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npp_check(rt_bm_2, ndraws = 50)\n```\n\n::: {.cell-output-display}\n![](ch-regression-lognorm_files/figure-html/rt-bm-2-pp-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconditional_effects(rt_bm_2)\n```\n\n::: {.cell-output-display}\n![](ch-regression-lognorm_files/figure-html/rt-bm-2-cond-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrt_bm_2_draws <- as_draws_df(rt_bm_2)\n\nrt_bm_2_draws <- rt_bm_2_draws |>\n  mutate(\n    real_log = b_Intercept,\n    nonce_log = b_Intercept + b_IsWordFALSE,\n    real = exp(real_log),\n    nonce_log = exp(nonce_log)\n  )\n```\n:::\n\n\n",
    "supporting": [
      "ch-regression-lognorm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}